
<!DOCTYPE html>
<html lang="en" style="height:100%">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="向宇的博客 | Xiang Yu&#39;s Blog">
    <title>Create Json By GAS and Deploy to S3 - 向宇的博客 | Xiang Yu&#39;s Blog</title>
    <meta name="author" content="Xiang Yu">
    
        <meta name="keywords" content="hexo,javascript,front-end,">
    
    
        <link rel="icon" href="https://kisky3.github.io/assets/images/pic.jpg">
    
    
        <link rel="alternate" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Xiang Yu","sameAs":["https://github.com/Kisky3","/categories/About-Me","kisky3@126.com"],"image":"me.png"},"articleBody":"用GAS造json数据并自动发布到S3上\n\n最近在开发中需要造一堆相似的阶层似的json数据。实在不想手动写，所以研究了一下如何用已经存在的文本文件来造出所需要的json数据，并能够自动deploy到S3上保存起来。\n准备工作首先需要在S3上生成上传所需要的user,policy和保存数据用的bucket，这能保证你在GAS中上传的时候能够使用改user，并且该user拥有上传json数据的权限和连接到你保存数据用的bucket.\n1. user和policy的生成：参照之前的文章IAM用户的生成在这里给user添加的policy要稍微修改一下，生成一个只能上传的policy例：\n1234567891011&#123;    &quot;Version&quot;: &quot;2012-10-17&quot;,    &quot;Statement&quot;: [        &#123;            &quot;Sid&quot;: &quot;VisualEditor0&quot;,            &quot;Effect&quot;: &quot;Allow&quot;,            &quot;Action&quot;: &quot;s3:PutObject&quot;,            &quot;Resource&quot;: &quot;*&quot;        &#125;    ]&#125;\n\n2. bucket的生成：bucket就直接在S3新建就好了，但是在access权限上，最好是设置成只能取得这个bucket数据的权限。例：\n12345678910111213&#123;    &quot;Version&quot;: &quot;2012-10-17&quot;,    &quot;Id&quot;: &quot;Policy1454907251774&quot;,    &quot;Statement&quot;: [        &#123;            &quot;Sid&quot;: &quot;Stmt1454907246553&quot;,            &quot;Effect&quot;: &quot;Allow&quot;,            &quot;Principal&quot;: &quot;*&quot;,            &quot;Action&quot;: &quot;s3:GetObject&quot;, // 只能取得数据的Action            &quot;Resource&quot;: &quot;arn:aws:s3:::your_bucket_name/*&quot;        &#125;    ]&#125;\n\n并在Bucket Property的地方选择并如下图般设置Static website hosting,并保存\n\nGAS的生成在准备工作做好之后就可以开始生成json数据的工作了。首先整理出你所需要的文字版数据。\n然后利用GAS的API来根据你文字版数据的sheet和内容生成你所需要的json。写法基本和普通的js差不多，取得数据后编辑成你所需要的形式，然后利用你刚刚生成的S3的user和bucket情报来进行数据的自动上传。\n在这里GAS的内容就不说明了，大概在方法里都写了注释。生成的是一个比较复杂的阶层式的json，写的比较粗糙。(sorry)\nGAS例：\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189/* domainによってjsonを生成してS3上にUPする ***********************************************************/// 個別のjsonを生成してS3上にUPするfunction CreateAndUploadJson() &#123;  const domain = \"xxxxxxxx\"  createCategoryData(domain)  UploadJson(domain)&#125;// 全てのjsonを一気に生成してUPする(重いので、こげる可能性がある)function CreateAndUploadAll() &#123;  const domain = [\"audio-takakuureru\", \"beauty-takakuureru\", \"bicycle-takakuureru\", \"brand-takakuureru\", \"camera-takakuureru\", \"delivery-kaitori\", \"figure-takakuureru\", \"fishing-takakuureru\", \"g-takakuureru\", \"gakki-takakuureru\", \"guitar-kaitori\", \"gun-takakuureru\", \"kaden-takakuureru\", \"kagu-takakuureru\", \"kenki-takakuureru\", \"kougu-takakuureru\", \"navi-takakuureru\", \"noukigu-takakuureru\", \"pc-takakuureru\", \"sax-takakuureru\", \"sports-takakuureru\", \"syuttyou-kaitori\", \"tokei-takakuureru\", \"train-takakuureru\", \"tv-takakuureru\"]　  domain.forEach(json_domain =&gt; &#123;    createCategoryData(json_domain)    UploadJson(json_domain)  &#125;)&#125;/* S3上Upload用 ***********************************************************/function UploadJson(domain) &#123;  var accessKey = 'xxxxxxxxxx';  var secretKey = \"xxxxxxxxxx\"  var bucketName = \"xxxxxxxxx\"  var spreadsheetId = 'xxxxxxxxxxxx'  var sheetName = domain;  const ss = SpreadsheetApp.getActiveSpreadsheet();  var sheet = ss.getSheetByName(sheetName);  // 生成されたシートからデータを取得  var data = String(sheet.getRange('A:A').getValues());  // もし文字列の最後「,」が存在する場合削除する  while (data.charAt(data.length - 1) == ',') &#123;    data = data.substr(0, data.length - 1);  &#125;  json = Utilities.newBlob(data, \"application/json\");  var s3 = S3.getInstance(accessKey, secretKey);  var response = s3.putObject(bucketName, sheetName + '.json', json, &#123;    logRequests: true  &#125;);  Logger.log(response);&#125;/* サイト毎のメイン処理 **********************************************/function createCategoryData(sheetName) &#123;  var sheet = SpreadsheetApp.getActive().getSheetByName(sheetName + '-data');  //dataへ変換  var dataArray = convSheet(sheet);  //dataをJsonに変換し、新規シート出力  creatNewSheet(dataArray, sheetName);&#125;//data（配列）へ変換関数function convSheet(sheet) &#123;  let categoryJson = []  Logger.log(sheet)  //領域  var jsonRange = sheet.getRange(2, 2, sheet.getLastRow() - 1, sheet.getLastColumn() - 1);  // Logger.log('jsonRange:'+JSON.stringify(jsonRange));  var jsonRowValues = jsonRange.getValues();  // Logger.log('jsonRowValues:'+JSON.stringify(jsonRowValues));  for (let i = 0; i &lt; jsonRowValues.length; i++) &#123;    const catLvlObj = categoryJson.filter(cat0 =&gt; cat0.title === jsonRowValues[i][0])    // 大カテゴリーは存在する場合、被るかどうかをチェック    if (!!Object.keys(catLvlObj).length) &#123;　      const cat1LvlObj = catLvlObj[0].options.filter(cat1 =&gt; cat1.title === jsonRowValues[i][1])      const att = CreateJson(jsonRowValues[i][5])      // 中カテゴリーは存在する場合、被るかどうかをチェック      　　      if (!!Object.keys(cat1LvlObj).length) &#123;　　　　        cat1LvlObj[0].options.push(&#123;          id: jsonRowValues[i][5],          title: jsonRowValues[i][2],          category: jsonRowValues[i][6],          attributes: att        &#125;)　　　　      &#125; else &#123;        // 中カテゴリーは値がない場合　追加        catLvlObj[0].options.push(&#123;          id: jsonRowValues[i][4],          title: jsonRowValues[i][1],          options: [&#123;            id: jsonRowValues[i][5],            title: jsonRowValues[i][2],            category: jsonRowValues[i][6],            attributes: att          &#125;]        &#125;)      &#125;      // 大カテゴリーは存在しない場合新規追加    &#125; else &#123;      let catNew = new Object      catNew.id = jsonRowValues[i][3]      catNew.title = jsonRowValues[i][0]      const att = CreateJson(jsonRowValues[i][5])      catNew.options = [&#123;        id: jsonRowValues[i][4],        title: jsonRowValues[i][1],        options: [&#123;          id: jsonRowValues[i][5],          title: jsonRowValues[i][2],          category: jsonRowValues[i][6],          attributes: att        &#125;]      &#125;]      categoryJson.push(catNew)    &#125;  &#125;  return categoryJson&#125;//新規シート作成関数function creatNewSheet(dataArray, sheetName) &#123;  //data(配列)よりJsonへ変換  var json = JSON.stringify(dataArray);  //出力  var newSheetName = sheetName;  //新規シート初期化  var newSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(newSheetName);  //存在有無確認  //存在しない場合  if (!newSheet) &#123;    //シート生成    newSheet = SpreadsheetApp.getActiveSpreadsheet();    newSheet.insertSheet(newSheetName);    //データ入力    newSheet.getRange(\"A1\").setValue(json);    //存在する場合  &#125; else &#123;    //データの書換え    newSheet.getRange(\"A1\").setValue(String(json));  &#125;&#125;// 追加項目リスト作成関数function CreateJson(cat2_id) &#123;  const ss = SpreadsheetApp.getActiveSpreadsheet();  const fieldSheet = ss.getSheetByName(\"抽出_format\");  const elementSheet = ss.getSheetByName(\"m_format_element\");  const fieldData = fieldSheet.getDataRange().getValues();  const elementData = elementSheet.getDataRange().getValues();  let value = []  for (let i = 2; i &lt; fieldData.length; i++) &#123;    const row = fieldData[i]    const outputFlg = row[0]    if (outputFlg === 0) continue;    let inputHint = row[2];    const sort = row[4];    const categoryId = row[6];    const formatId = row[7];    const name = row[9];    const formatType = row[13];    const fieldKey = row[14];    // validate rule    const rules = []    const required = row[3];    const maxLength = row[10];    if (required === 1) &#123;      rules.push(\"required\")    &#125;    if (maxLength !== \"\") &#123;      rules.push(`max:$&#123;maxLength&#125;`)    &#125;    // select, radioのoptions    let elements;    if (formatType === \"select\" || formatType === \"radio\") &#123;      elements = elementData.filter(row =&gt; row[0] === formatId).map(row =&gt; row[2])      if (formatType === \"radio\") &#123;        const radioObj = []        elements.map(el =&gt; radioObj.push(&#123;          label: el,          value: el        &#125;))        elements = radioObj      &#125;    &#125;    if (row[6] === Number(cat2_id)) &#123;      value.push(&#123;        \"field_name\": name,        \"field_key\": fieldKey,        \"type\": formatType,        \"required\": `$&#123;required === 1&#125;`,        \"rules\": `$&#123;rules.length &gt; 0 ? rules.join(\"|\") : \"\"&#125;`,        \"options\": elements === null ? \"\" : elements,        \"hint\": `$&#123;inputHint === null ? \"\" : inputHint&#125;`,        \"sort\": sort,        \"format_id\": formatId      &#125;)    &#125;  &#125;  return value&#125;\n\n\n生成结果执行以上GAS的CreateAndUploadJson方法，就可以看到json数据被生成了sheet,并上传到了你指定的S3 Bucket上。\n以上\n\n参考多分保存版？S3とSpreadSheet間でのCSVとJSONのデータ読み書きを簡単なサンプルで網羅してみた\nGoogle Apps Scriptを利用してGoogleスプレッドシートのデータをS3へJSONとして保存する\n","dateCreated":"2020-03-12T17:13:07+09:00","dateModified":"2021-05-13T23:53:29+09:00","datePublished":"2020-03-12T17:13:07+09:00","description":"用GAS造json数据并自动发布到S3上","headline":"Create Json By GAS and Deploy to S3","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://kisky3.github.io/2020/03/12/createJsonByGAS/"},"publisher":{"@type":"Organization","name":"Xiang Yu","sameAs":["https://github.com/Kisky3","/categories/About-Me","kisky3@126.com"],"image":"me.png","logo":{"@type":"ImageObject","url":"me.png"}},"url":"https://kisky3.github.io/2020/03/12/createJsonByGAS/","keywords":"google app script, json, s3, deploy"}</script>
    <meta name="description" content="用GAS造json数据并自动发布到S3上">
<meta name="keywords" content="google app script,json,s3,deploy">
<meta property="og:type" content="blog">
<meta property="og:title" content="Create Json By GAS and Deploy to S3">
<meta property="og:url" content="https://kisky3.github.io/2020/03/12/createJsonByGAS/index.html">
<meta property="og:site_name" content="向宇的博客 | Xiang Yu&#39;s Blog">
<meta property="og:description" content="用GAS造json数据并自动发布到S3上">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://kisky3.github.io/2020/03/12/createJsonByGAS/1.png">
<meta property="og:image" content="https://kisky3.github.io/2020/03/12/createJsonByGAS/2.png">
<meta property="og:image" content="https://kisky3.github.io/2020/03/12/createJsonByGAS/3.png">
<meta property="og:updated_time" content="2021-05-13T14:53:29.579Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Create Json By GAS and Deploy to S3">
<meta name="twitter:description" content="用GAS造json数据并自动发布到S3上">
<meta name="twitter:image" content="https://kisky3.github.io/2020/03/12/createJsonByGAS/1.png">
    
    
        
    
    
        <meta property="og:image" content="https://kisky3.github.io/assets/images/me.png"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-txbv5drjurwncpxzv0lwwxgxavlzvpof5vrmy1qtqmjcvn9vllzopibimgon.min.css">
    <!--STYLES END-->
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143035141-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-143035141-1');
    </script>


    
</head>

    <body style="margin: 0; height:100%">
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="3">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">向宇的博客 | Xiang Yu&#39;s Blog</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/me.png" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="3">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/me.png" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">Xiang Yu</h4>
                
                    <h5 class="sidebar-profile-bio"><p>Front-end DeveloperDeveloper</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/Kisky3" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/categories/About-Me"
                            
                            title="Diaries"
                        >
                    
                        <i class="sidebar-button-icon fa fa-book" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Diaries</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/kisky3@126.com"
                            title="Mail"
                        >
                    
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/atom.xml"
                            
                            title="RSS"
                        >
                    
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="3"
                 class="
                        hasCoverMetaIn
                        hasCoverCaption">
                
<article class="post">
    
        <span class="post-header-cover-caption caption">Hello World, Hello Programming</span>
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            Create Json By GAS and Deploy to S3
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-03-12T17:13:07+09:00">
	
		    Mar 12, 2020
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Front-end-Knowledge/">Front-end Knowledge</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>用GAS造json数据并自动发布到S3上</p>
<a id="more"></a>
<p>最近在开发中需要造一堆相似的阶层似的json数据。<br>实在不想手动写，所以研究了一下如何用已经存在的文本文件来造出所需要的json数据，并能够自动deploy到S3上保存起来。</p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>首先需要在S3上生成上传所需要的user,policy和保存数据用的bucket，<br>这能保证你在GAS中上传的时候能够使用改user，并且该user拥有上传json数据的权限和连接到你保存数据用的bucket.</p>
<h4 id="1-user和policy的生成："><a href="#1-user和policy的生成：" class="headerlink" title="1. user和policy的生成："></a>1. user和policy的生成：</h4><p>参照之前的文章<a href="https://kisky3.github.io/2020/02/10/UseServerlessFrameworkToCreateRESTAPI/">IAM用户的生成</a><br>在这里给user添加的policy要稍微修改一下，生成一个只能上传的policy<br>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br><span class="line">    &quot;Statement&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Sid&quot;: &quot;VisualEditor0&quot;,</span><br><span class="line">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br><span class="line">            &quot;Action&quot;: &quot;s3:PutObject&quot;,</span><br><span class="line">            &quot;Resource&quot;: &quot;*&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-bucket的生成："><a href="#2-bucket的生成：" class="headerlink" title="2. bucket的生成："></a>2. bucket的生成：</h4><p>bucket就直接在S3新建就好了，但是在access权限上，最好是设置成只能取得这个bucket数据的权限。<br>例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;Version&quot;: &quot;2012-10-17&quot;,</span><br><span class="line">    &quot;Id&quot;: &quot;Policy1454907251774&quot;,</span><br><span class="line">    &quot;Statement&quot;: [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;Sid&quot;: &quot;Stmt1454907246553&quot;,</span><br><span class="line">            &quot;Effect&quot;: &quot;Allow&quot;,</span><br><span class="line">            &quot;Principal&quot;: &quot;*&quot;,</span><br><span class="line">            &quot;Action&quot;: &quot;s3:GetObject&quot;, // 只能取得数据的Action</span><br><span class="line">            &quot;Resource&quot;: &quot;arn:aws:s3:::your_bucket_name/*&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>并在Bucket Property的地方选择并如下图般设置Static website hosting,并保存<br><img src="./1.png" style="width:400px;margin:40px 0"></p>
<hr>
<h3 id="GAS的生成"><a href="#GAS的生成" class="headerlink" title="GAS的生成"></a>GAS的生成</h3><p>在准备工作做好之后就可以开始生成json数据的工作了。<br>首先整理出你所需要的文字版数据。<br><img src="./2.png" style="width:400px;margin:40px 0"></p>
<p>然后利用GAS的API来根据你文字版数据的sheet和内容生成你所需要的json。<br>写法基本和普通的js差不多，取得数据后编辑成你所需要的形式，<br>然后利用你刚刚生成的S3的user和bucket情报来进行数据的自动上传。</p>
<p>在这里GAS的内容就不说明了，大概在方法里都写了注释。<br>生成的是一个比较复杂的阶层式的json，写的比较粗糙。(sorry)</p>
<p>GAS例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* domainによってjsonを生成してS3上にUPする ***********************************************************/</span></span><br><span class="line"><span class="comment">// 個別のjsonを生成してS3上にUPする</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreateAndUploadJson</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> domain = <span class="string">"xxxxxxxx"</span></span><br><span class="line">  createCategoryData(domain)</span><br><span class="line">  UploadJson(domain)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全てのjsonを一気に生成してUPする(重いので、こげる可能性がある)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreateAndUploadAll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> domain = [<span class="string">"audio-takakuureru"</span>, <span class="string">"beauty-takakuureru"</span>, <span class="string">"bicycle-takakuureru"</span>, <span class="string">"brand-takakuureru"</span>, <span class="string">"camera-takakuureru"</span>, <span class="string">"delivery-kaitori"</span>, <span class="string">"figure-takakuureru"</span>, <span class="string">"fishing-takakuureru"</span>, <span class="string">"g-takakuureru"</span>, <span class="string">"gakki-takakuureru"</span>, <span class="string">"guitar-kaitori"</span>, <span class="string">"gun-takakuureru"</span>, <span class="string">"kaden-takakuureru"</span>, <span class="string">"kagu-takakuureru"</span>, <span class="string">"kenki-takakuureru"</span>, <span class="string">"kougu-takakuureru"</span>, <span class="string">"navi-takakuureru"</span>, <span class="string">"noukigu-takakuureru"</span>, <span class="string">"pc-takakuureru"</span>, <span class="string">"sax-takakuureru"</span>, <span class="string">"sports-takakuureru"</span>, <span class="string">"syuttyou-kaitori"</span>, <span class="string">"tokei-takakuureru"</span>, <span class="string">"train-takakuureru"</span>, <span class="string">"tv-takakuureru"</span>]　</span><br><span class="line">  domain.forEach(<span class="function"><span class="params">json_domain</span> =&gt;</span> &#123;</span><br><span class="line">    createCategoryData(json_domain)</span><br><span class="line">    UploadJson(json_domain)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* S3上Upload用 ***********************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">UploadJson</span>(<span class="params">domain</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> accessKey = <span class="string">'xxxxxxxxxx'</span>;</span><br><span class="line">  <span class="keyword">var</span> secretKey = <span class="string">"xxxxxxxxxx"</span></span><br><span class="line">  <span class="keyword">var</span> bucketName = <span class="string">"xxxxxxxxx"</span></span><br><span class="line">  <span class="keyword">var</span> spreadsheetId = <span class="string">'xxxxxxxxxxxx'</span></span><br><span class="line">  <span class="keyword">var</span> sheetName = domain;</span><br><span class="line">  <span class="keyword">const</span> ss = SpreadsheetApp.getActiveSpreadsheet();</span><br><span class="line">  <span class="keyword">var</span> sheet = ss.getSheetByName(sheetName);</span><br><span class="line">  <span class="comment">// 生成されたシートからデータを取得</span></span><br><span class="line">  <span class="keyword">var</span> data = <span class="built_in">String</span>(sheet.getRange(<span class="string">'A:A'</span>).getValues());</span><br><span class="line">  <span class="comment">// もし文字列の最後「,」が存在する場合削除する</span></span><br><span class="line">  <span class="keyword">while</span> (data.charAt(data.length - <span class="number">1</span>) == <span class="string">','</span>) &#123;</span><br><span class="line">    data = data.substr(<span class="number">0</span>, data.length - <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  json = Utilities.newBlob(data, <span class="string">"application/json"</span>);</span><br><span class="line">  <span class="keyword">var</span> s3 = S3.getInstance(accessKey, secretKey);</span><br><span class="line">  <span class="keyword">var</span> response = s3.putObject(bucketName, sheetName + <span class="string">'.json'</span>, json, &#123;</span><br><span class="line">    logRequests: <span class="literal">true</span></span><br><span class="line">  &#125;);</span><br><span class="line">  Logger.log(response);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* サイト毎のメイン処理 **********************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createCategoryData</span>(<span class="params">sheetName</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> sheet = SpreadsheetApp.getActive().getSheetByName(sheetName + <span class="string">'-data'</span>);</span><br><span class="line">  <span class="comment">//dataへ変換</span></span><br><span class="line">  <span class="keyword">var</span> dataArray = convSheet(sheet);</span><br><span class="line">  <span class="comment">//dataをJsonに変換し、新規シート出力</span></span><br><span class="line">  creatNewSheet(dataArray, sheetName);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//data（配列）へ変換関数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">convSheet</span>(<span class="params">sheet</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> categoryJson = []</span><br><span class="line">  Logger.log(sheet)</span><br><span class="line">  <span class="comment">//領域</span></span><br><span class="line">  <span class="keyword">var</span> jsonRange = sheet.getRange(<span class="number">2</span>, <span class="number">2</span>, sheet.getLastRow() - <span class="number">1</span>, sheet.getLastColumn() - <span class="number">1</span>);</span><br><span class="line">  <span class="comment">// Logger.log('jsonRange:'+JSON.stringify(jsonRange));</span></span><br><span class="line">  <span class="keyword">var</span> jsonRowValues = jsonRange.getValues();</span><br><span class="line">  <span class="comment">// Logger.log('jsonRowValues:'+JSON.stringify(jsonRowValues));</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; jsonRowValues.length; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> catLvlObj = categoryJson.filter(<span class="function"><span class="params">cat0</span> =&gt;</span> cat0.title === jsonRowValues[i][<span class="number">0</span>])</span><br><span class="line">    <span class="comment">// 大カテゴリーは存在する場合、被るかどうかをチェック</span></span><br><span class="line">    <span class="keyword">if</span> (!!<span class="built_in">Object</span>.keys(catLvlObj).length) &#123;　</span><br><span class="line">      <span class="keyword">const</span> cat1LvlObj = catLvlObj[<span class="number">0</span>].options.filter(<span class="function"><span class="params">cat1</span> =&gt;</span> cat1.title === jsonRowValues[i][<span class="number">1</span>])</span><br><span class="line">      <span class="keyword">const</span> att = CreateJson(jsonRowValues[i][<span class="number">5</span>])</span><br><span class="line">      <span class="comment">// 中カテゴリーは存在する場合、被るかどうかをチェック</span></span><br><span class="line">      　　</span><br><span class="line">      <span class="keyword">if</span> (!!<span class="built_in">Object</span>.keys(cat1LvlObj).length) &#123;　　　　</span><br><span class="line">        cat1LvlObj[<span class="number">0</span>].options.push(&#123;</span><br><span class="line">          id: jsonRowValues[i][<span class="number">5</span>],</span><br><span class="line">          title: jsonRowValues[i][<span class="number">2</span>],</span><br><span class="line">          category: jsonRowValues[i][<span class="number">6</span>],</span><br><span class="line">          attributes: att</span><br><span class="line">        &#125;)　　　　</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 中カテゴリーは値がない場合　追加</span></span><br><span class="line">        catLvlObj[<span class="number">0</span>].options.push(&#123;</span><br><span class="line">          id: jsonRowValues[i][<span class="number">4</span>],</span><br><span class="line">          title: jsonRowValues[i][<span class="number">1</span>],</span><br><span class="line">          options: [&#123;</span><br><span class="line">            id: jsonRowValues[i][<span class="number">5</span>],</span><br><span class="line">            title: jsonRowValues[i][<span class="number">2</span>],</span><br><span class="line">            category: jsonRowValues[i][<span class="number">6</span>],</span><br><span class="line">            attributes: att</span><br><span class="line">          &#125;]</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 大カテゴリーは存在しない場合新規追加</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> catNew = <span class="keyword">new</span> <span class="built_in">Object</span></span><br><span class="line">      catNew.id = jsonRowValues[i][<span class="number">3</span>]</span><br><span class="line">      catNew.title = jsonRowValues[i][<span class="number">0</span>]</span><br><span class="line">      <span class="keyword">const</span> att = CreateJson(jsonRowValues[i][<span class="number">5</span>])</span><br><span class="line">      catNew.options = [&#123;</span><br><span class="line">        id: jsonRowValues[i][<span class="number">4</span>],</span><br><span class="line">        title: jsonRowValues[i][<span class="number">1</span>],</span><br><span class="line">        options: [&#123;</span><br><span class="line">          id: jsonRowValues[i][<span class="number">5</span>],</span><br><span class="line">          title: jsonRowValues[i][<span class="number">2</span>],</span><br><span class="line">          category: jsonRowValues[i][<span class="number">6</span>],</span><br><span class="line">          attributes: att</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;]</span><br><span class="line">      categoryJson.push(catNew)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> categoryJson</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//新規シート作成関数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">creatNewSheet</span>(<span class="params">dataArray, sheetName</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//data(配列)よりJsonへ変換</span></span><br><span class="line">  <span class="keyword">var</span> json = <span class="built_in">JSON</span>.stringify(dataArray);</span><br><span class="line">  <span class="comment">//出力</span></span><br><span class="line">  <span class="keyword">var</span> newSheetName = sheetName;</span><br><span class="line">  <span class="comment">//新規シート初期化</span></span><br><span class="line">  <span class="keyword">var</span> newSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(newSheetName);</span><br><span class="line">  <span class="comment">//存在有無確認</span></span><br><span class="line">  <span class="comment">//存在しない場合</span></span><br><span class="line">  <span class="keyword">if</span> (!newSheet) &#123;</span><br><span class="line">    <span class="comment">//シート生成</span></span><br><span class="line">    newSheet = SpreadsheetApp.getActiveSpreadsheet();</span><br><span class="line">    newSheet.insertSheet(newSheetName);</span><br><span class="line">    <span class="comment">//データ入力</span></span><br><span class="line">    newSheet.getRange(<span class="string">"A1"</span>).setValue(json);</span><br><span class="line">    <span class="comment">//存在する場合</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//データの書換え</span></span><br><span class="line">    newSheet.getRange(<span class="string">"A1"</span>).setValue(<span class="built_in">String</span>(json));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 追加項目リスト作成関数</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreateJson</span>(<span class="params">cat2_id</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> ss = SpreadsheetApp.getActiveSpreadsheet();</span><br><span class="line">  <span class="keyword">const</span> fieldSheet = ss.getSheetByName(<span class="string">"抽出_format"</span>);</span><br><span class="line">  <span class="keyword">const</span> elementSheet = ss.getSheetByName(<span class="string">"m_format_element"</span>);</span><br><span class="line">  <span class="keyword">const</span> fieldData = fieldSheet.getDataRange().getValues();</span><br><span class="line">  <span class="keyword">const</span> elementData = elementSheet.getDataRange().getValues();</span><br><span class="line">  <span class="keyword">let</span> value = []</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt; fieldData.length; i++) &#123;</span><br><span class="line">    <span class="keyword">const</span> row = fieldData[i]</span><br><span class="line">    <span class="keyword">const</span> outputFlg = row[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> (outputFlg === <span class="number">0</span>) <span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">let</span> inputHint = row[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">const</span> sort = row[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">const</span> categoryId = row[<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">const</span> formatId = row[<span class="number">7</span>];</span><br><span class="line">    <span class="keyword">const</span> name = row[<span class="number">9</span>];</span><br><span class="line">    <span class="keyword">const</span> formatType = row[<span class="number">13</span>];</span><br><span class="line">    <span class="keyword">const</span> fieldKey = row[<span class="number">14</span>];</span><br><span class="line">    <span class="comment">// validate rule</span></span><br><span class="line">    <span class="keyword">const</span> rules = []</span><br><span class="line">    <span class="keyword">const</span> required = row[<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">const</span> maxLength = row[<span class="number">10</span>];</span><br><span class="line">    <span class="keyword">if</span> (required === <span class="number">1</span>) &#123;</span><br><span class="line">      rules.push(<span class="string">"required"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (maxLength !== <span class="string">""</span>) &#123;</span><br><span class="line">      rules.push(<span class="string">`max:<span class="subst">$&#123;maxLength&#125;</span>`</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// select, radioのoptions</span></span><br><span class="line">    <span class="keyword">let</span> elements;</span><br><span class="line">    <span class="keyword">if</span> (formatType === <span class="string">"select"</span> || formatType === <span class="string">"radio"</span>) &#123;</span><br><span class="line">      elements = elementData.filter(<span class="function"><span class="params">row</span> =&gt;</span> row[<span class="number">0</span>] === formatId).map(<span class="function"><span class="params">row</span> =&gt;</span> row[<span class="number">2</span>])</span><br><span class="line">      <span class="keyword">if</span> (formatType === <span class="string">"radio"</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> radioObj = []</span><br><span class="line">        elements.map(<span class="function"><span class="params">el</span> =&gt;</span> radioObj.push(&#123;</span><br><span class="line">          label: el,</span><br><span class="line">          value: el</span><br><span class="line">        &#125;))</span><br><span class="line">        elements = radioObj</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (row[<span class="number">6</span>] === <span class="built_in">Number</span>(cat2_id)) &#123;</span><br><span class="line">      value.push(&#123;</span><br><span class="line">        <span class="string">"field_name"</span>: name,</span><br><span class="line">        <span class="string">"field_key"</span>: fieldKey,</span><br><span class="line">        <span class="string">"type"</span>: formatType,</span><br><span class="line">        <span class="string">"required"</span>: <span class="string">`<span class="subst">$&#123;required === <span class="number">1</span>&#125;</span>`</span>,</span><br><span class="line">        <span class="string">"rules"</span>: <span class="string">`<span class="subst">$&#123;rules.length &gt; <span class="number">0</span> ? rules.join(<span class="string">"|"</span>) : <span class="string">""</span>&#125;</span>`</span>,</span><br><span class="line">        <span class="string">"options"</span>: elements === <span class="literal">null</span> ? <span class="string">""</span> : elements,</span><br><span class="line">        <span class="string">"hint"</span>: <span class="string">`<span class="subst">$&#123;inputHint === <span class="literal">null</span> ? <span class="string">""</span> : inputHint&#125;</span>`</span>,</span><br><span class="line">        <span class="string">"sort"</span>: sort,</span><br><span class="line">        <span class="string">"format_id"</span>: formatId</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h3 id="生成结果"><a href="#生成结果" class="headerlink" title="生成结果"></a>生成结果</h3><p>执行以上GAS的CreateAndUploadJson方法，就可以看到json数据被生成了sheet,并上传到了你指定的S3 Bucket上。<br><img src="./3.png" style="width:400px;margin:40px 0"></p>
<p>以上</p>
<hr>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://dev.classmethod.jp/articles/csv-and-json-convert-between-s3-and-spreadsheet/" target="_blank" rel="noopener">多分保存版？S3とSpreadSheet間でのCSVとJSONのデータ読み書きを簡単なサンプルで網羅してみた</a></p>
<p><a href="https://dev.classmethod.jp/articles/google-apps-script-gss-to-s3-json/" target="_blank" rel="noopener">Google Apps Scriptを利用してGoogleスプレッドシートのデータをS3へJSONとして保存する</a></p>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/deploy/">deploy</a> <a class="tag tag--primary tag--small t-link" href="/tags/google-app-script/">google app script</a> <a class="tag tag--primary tag--small t-link" href="/tags/json/">json</a> <a class="tag tag--primary tag--small t-link" href="/tags/s3/">s3</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2020/03/18/DeleteAmazonCloudFrontCache/" data-tooltip="Delete Amazon Cloud Front Cache(Invalidation)" aria-label="PREVIOUS: Delete Amazon Cloud Front Cache(Invalidation)">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2020/03/08/GitRepositoryCOmmitUserName/" data-tooltip="Set Repository-specific Username/Email" aria-label="NEXT: Set Repository-specific Username/Email">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/xiang.yu.39794" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=https://kisky3.github.io/2020/03/12/createJsonByGAS/" title="global.share_on_movies">
                    <i class="fa file-video" aria-hidden="true"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
    </div>
</article>


                <footer id="footer" class="main-content-wrap">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        Page Views:<span id="busuanzi_value_site_pv"></span><span id="busuanzi_container_site_pv"></span>
        <span class="post-meta-divider">|</span>
        Visitors:<span id="busuanzi_value_site_uv"></span><span id="busuanzi_container_site_uv"></span>
        <br>
    <span class="copyrights">
        Copyrights &copy; 2021 Xiang Yu. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="3">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2020/03/18/DeleteAmazonCloudFrontCache/" data-tooltip="Delete Amazon Cloud Front Cache(Invalidation)" aria-label="PREVIOUS: Delete Amazon Cloud Front Cache(Invalidation)">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2020/03/08/GitRepositoryCOmmitUserName/" data-tooltip="Set Repository-specific Username/Email" aria-label="NEXT: Set Repository-specific Username/Email">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/xiang.yu.39794" title="Share on Facebook">
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a class="post-action-btn btn btn--default" target="new" href="http://service.weibo.com/share/share.php?&amp;title=https://kisky3.github.io/2020/03/12/createJsonByGAS/" title="global.share_on_movies">
                    <i class="fa file-video" aria-hidden="true"></i>
                </a>
            </li>
        
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="3">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="https://www.facebook.com/xiang.yu.39794">
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a class="share-option-btn" target="new" href="http://service.weibo.com/share/share.php?&amp;title=https://kisky3.github.io/2020/03/12/createJsonByGAS/">
                        <i class="fa file-video" aria-hidden="true"></i><span>global.share_on_movies</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/me.png" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">Xiang Yu</h4>
        
            <div id="about-card-bio"><p>Front-end developer living in Tokyo     Chinese &amp; Japanese &amp; English</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Front-end developer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Tokyo
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>

        <!--SCRIPTS-->
<script src="/assets/js/script-wqqb8bbbj9igtm4n3bzccarnx9r51u7u12cdzdqad027xmgqdfsi77py0qap.min.js"></script>
<!--SCRIPTS END-->



    <script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.9}});</script></body>
</html>
